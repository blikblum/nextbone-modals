{"version":3,"file":"nextbone-modals.js","sources":["../src/service.js","../src/region.js","../src/bootstrap-views.js","../src/bootstrap.js"],"sourcesContent":["import { Service } from 'nextbone-service'\r\nimport _ from 'underscore'\r\n\r\n/**\r\n * @class Modals\r\n */\r\nexport class Modals extends Service {\r\n  /**\r\n   * @abstract\r\n   * @method requests\r\n   */\r\n  static get requests () {\r\n    return {\r\n      open: 'open',\r\n      close: 'close',\r\n      alert: 'alert',\r\n      confirm: 'confirm',\r\n      prompt: 'prompt',\r\n      dialog: 'dialog'\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @constructs Modals\r\n   */\r\n  constructor (channelName) {\r\n    super(channelName)\r\n    this.views = []\r\n  }\r\n\r\n  createElement (type) {\r\n    return document.createElement(`nextbone-modal-${type}`)\r\n  }\r\n\r\n  /**\r\n   * @method open\r\n   * @param {Backbone.View} [view]\r\n   * @returns {Promise}\r\n   */\r\n  open (view, options) {\r\n    let previousView\r\n    view.options = options\r\n    return Promise.resolve().then(() => {\r\n      this.trigger('before:open', view, options)\r\n      this._isOpen = true\r\n\r\n      previousView = _.last(this.views)\r\n      this.views.push(view)\r\n\r\n      return this.render(view, options)\r\n    }).then(() => {\r\n      if (previousView) {\r\n        return this.animateSwap(previousView, view, options)\r\n      } else {\r\n        return this.animateIn(view, options)\r\n      }\r\n    }).then(() => {\r\n      this.trigger('open', view, options)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method close\r\n   * @param {Backbone.View} [view]\r\n   * @returns {Promise}\r\n   */\r\n  close (view, options) {\r\n    let previousView\r\n    let views\r\n\r\n    return Promise.resolve().then(() => {\r\n      if (view) {\r\n        this.trigger('before:close', view, options)\r\n      } else {\r\n        _.map(this.views, view => this.trigger('before:close', view, options))\r\n      }\r\n\r\n      this._isOpen = false\r\n\r\n      if (view) {\r\n        views = this.views = _.without(this.views, view)\r\n      } else {\r\n        views = this.views\r\n        this.views = []\r\n      }\r\n\r\n      previousView = _.last(views)\r\n\r\n      if (view && previousView) {\r\n        return this.animateSwap(view, previousView, options)\r\n      } else if (view) {\r\n        return this.animateOut(view, options)\r\n      } else if (previousView) {\r\n        return this.animateOut(previousView, options)\r\n      }\r\n    }).then(() => {\r\n      if (view) {\r\n        return this.remove(view, options)\r\n      } else {\r\n        return Promise.all(_.map(views, view => this.remove(view, options)))\r\n      }\r\n    }).then(() => {\r\n      if (view) {\r\n        this.trigger('close', view, options)\r\n      } else {\r\n        _.map(views, view => this.trigger('close', view, options))\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method alert\r\n   * @param {Object} [options]\r\n   * @returns {Promise}\r\n   */\r\n  alert (options) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('alert')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:alert', view, options)\r\n\r\n      view.on('confirm cancel', () => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('alert', null, view, options))\r\n          .then(() => resolve(), reject)\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method confirm\r\n   * @param {Object} [options]\r\n   * @returns {Promise}\r\n   */\r\n  confirm (options) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('confirm')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:confirm', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('confirm', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        confirm: () => close(true),\r\n        cancel: () => close(false)\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method prompt\r\n   * @returns {Promise}\r\n   */\r\n  prompt (options) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('prompt')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:prompt', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('prompt', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        submit: text => close(text),\r\n        cancel: () => close()\r\n      })\r\n    })\r\n  }\r\n\r\n  dialog (view, options) {\r\n    if (!view) {\r\n      throw new Error('ModalService: no view option passed to dialog')\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:dialog', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('dialog', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        submit: data => close(data),\r\n        cancel: () => close()\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method isOpen\r\n   * @returns {Boolean}\r\n   */\r\n  isOpen () {\r\n    return !!this._isOpen\r\n  }\r\n\r\n  /**\r\n   * @abstract\r\n   * @method render\r\n   */\r\n  render () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method remove\r\n   */\r\n  remove () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateIn\r\n   */\r\n  animateIn () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateSwap\r\n   */\r\n  animateSwap () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateOut\r\n   */\r\n  animateOut () {}\r\n}\r\n","export class Region {\n  constructor (targetEl) {\n    this.targetEl = targetEl\n    this.isSwappingEl = false\n    this.currentEl = undefined\n  }\n\n  show (el) {\n    this.isSwappingEl = this.currentEl !== undefined\n\n    if (this.currentEl) {\n      this.empty()\n    }\n\n    this.attachEl(el)\n\n    this.currentEl = el\n    this.isSwappingEl = false\n  }\n\n  empty () {\n    if (this.currentEl) {\n      this.detachEl(this.currentEl)\n    }\n    this.currentEl = undefined\n  }\n\n  attachEl (el) {\n    this.targetEl.appendChild(el)\n  }\n\n  detachEl (el) {\n    this.targetEl.removeChild(el)\n  }\n}\n","import { Events } from 'nextbone'\r\n\r\nconst defaultCaptions = {\r\n  ok: 'OK',\r\n  cancel: 'Cancel',\r\n  yes: 'Yes',\r\n  no: 'No'\r\n}\r\n\r\nclass BaseModal extends HTMLElement {\r\n  confirmClick () {\r\n    this.trigger('confirm')\r\n  }\r\n\r\n  cancelClick (e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    this.trigger('cancel')\r\n  }\r\n\r\n  submit (e) {\r\n    e.preventDefault()\r\n    const val = this.querySelector('input').value\r\n    this.trigger('submit', val)\r\n  }\r\n\r\n  bindEvent (selector, event, listener) {\r\n    const el = this.querySelector(selector)\r\n    if (el) el.addEventListener(event, listener.bind(this))\r\n  }\r\n\r\n  connectedCallback () {\r\n    this.innerHTML = this.render(this.options)\r\n    this.bindEvent('.btn-primary', 'click', this.confirmClick)\r\n    this.bindEvent('.close', 'click', this.cancelClick)\r\n    this.bindEvent('.btn-secondary', 'click', this.cancelClick)\r\n    this.bindEvent('submit', 'submit', this.submit)\r\n  }\r\n}\r\n\r\nEvents.extend(BaseModal.prototype)\r\n\r\nclass AlertView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <div class=\"modal-header\">\r\n      <h5 class=\"modal-title\">${data.title}</h5>\r\n      <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n    </div>\r\n\r\n    <div class=\"modal-body\">\r\n      <p>${data.text}</p>\r\n    </div>\r\n\r\n    <div class=\"modal-footer\">\r\n      <button type=\"button\" class=\"btn btn-primary\">${data.ok || defaultCaptions.ok}</button>\r\n    </div>\r\n    `\r\n  }\r\n}\r\n\r\nclass PromptView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <form>\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\">${data.title}</h5>\r\n        <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n      </div>\r\n\r\n      <div class=\"modal-body\">\r\n        <div class=\"form-group\">\r\n          <label for=\"modal__input--prompt\">${data.text}</label>\r\n          <input id=\"modal__input--prompt\" class=\"form-control\" type=\"text\" value=\"${data.value || ''}\">\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\">${data.cancel || defaultCaptions.cancel}</button>\r\n        <button type=\"submit\" class=\"btn btn-primary\">${data.ok || defaultCaptions.ok}</button>\r\n      </div>\r\n    </form>\r\n    `\r\n  }\r\n}\r\n\r\nclass ConfirmView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <div class=\"modal-header\">\r\n      <h5 class=\"modal-title\">${data.title}</h5>\r\n      <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n    </div>\r\n    \r\n    <div class=\"modal-body\">\r\n      <p>${data.text}</p>\r\n    </div>\r\n    \r\n    <div class=\"modal-footer\">\r\n      <button type=\"button\" class=\"btn btn-secondary\">${data.no || defaultCaptions.no}</button>\r\n      <button type=\"button\" class=\"btn btn-primary\">${data.yes || defaultCaptions.yes}</button>\r\n    </div>      \r\n    `\r\n  }\r\n}\r\n\r\nexport { AlertView, ConfirmView, PromptView, defaultCaptions }\r\n","import { Modals } from './service'\r\nimport $ from 'jquery'\r\nimport { Region } from './region'\r\nimport { AlertView, PromptView, ConfirmView, defaultCaptions } from './bootstrap-views'\r\n\r\nconst layoutTemplate = `\r\n<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\"></div>\r\n  </div>\r\n</div>\r\n`\r\n\r\nconst elementClasses = {\r\n  alert: AlertView,\r\n  prompt: PromptView,\r\n  confirm: ConfirmView\r\n}\r\n\r\nexport class BootstrapModals extends Modals {\r\n  static setCaptions (captions = {}) {\r\n    Object.assign(defaultCaptions, captions)\r\n  }\r\n\r\n  setup (options = {}) {\r\n    this.container = options.container\r\n  }\r\n\r\n  createElement (type) {\r\n    const name = `bootstrap-modal-${type}`\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, elementClasses[type])\r\n    }\r\n    return document.createElement(name)\r\n  }\r\n\r\n  start () {\r\n    if (!this.container) {\r\n      throw new Error('Bootstrap Modals: container option is not defined')\r\n    }\r\n\r\n    const $container = $(this.container)\r\n    if (!$container.length) {\r\n      throw new Error(`Bootstrap Modals: unable to find container element (${this.container})`)\r\n    }\r\n\r\n    $container.html(layoutTemplate)\r\n\r\n    const $layout = this.$layout = $container.children().eq(0)\r\n\r\n    $layout.modal({\r\n      show: false,\r\n      backdrop: 'static'\r\n    })\r\n\r\n    $layout.on({\r\n      'shown.bs.modal': (e) => this.trigger('modal:show', e),\r\n      'hidden.bs.modal': (e) => this.trigger('modal:hide', e)\r\n    })\r\n\r\n    this.contentRegion = new Region($layout.find('.modal-content')[0])\r\n  }\r\n\r\n  render (view) {\r\n    this.contentRegion.show(view)\r\n  }\r\n\r\n  remove () {\r\n    this.contentRegion.empty()\r\n  }\r\n\r\n  animateIn () {\r\n    return new Promise(resolve => {\r\n      this.once('modal:show', resolve)\r\n      this.$layout.modal('show')\r\n    })\r\n  }\r\n\r\n  animateOut () {\r\n    return new Promise(resolve => {\r\n      this.once('modal:hide', resolve)\r\n      this.$layout.modal('hide')\r\n    })\r\n  }\r\n}\r\n"],"names":["Modals","Service","requests","open","close","alert","confirm","prompt","dialog","constructor","channelName","views","createElement","type","document","view","options","previousView","Promise","resolve","then","trigger","_isOpen","_","last","push","render","animateSwap","animateIn","map","without","animateOut","remove","all","reject","promise","on","result","cancel","submit","text","Error","data","isOpen","Region","targetEl","isSwappingEl","currentEl","undefined","show","el","empty","attachEl","detachEl","appendChild","removeChild","defaultCaptions","ok","yes","no","BaseModal","HTMLElement","confirmClick","cancelClick","e","stopPropagation","preventDefault","val","querySelector","value","bindEvent","selector","event","listener","addEventListener","bind","connectedCallback","innerHTML","Events","extend","prototype","AlertView","title","PromptView","ConfirmView","layoutTemplate","elementClasses","BootstrapModals","setCaptions","captions","Object","assign","setup","container","name","customElements","get","define","start","$container","$","length","html","$layout","children","eq","modal","backdrop","contentRegion","find","once"],"mappings":"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"}