{"version":3,"file":"nextbone-modals.js","sources":["../src/service.js","../src/bootstrap-views.js","../src/bootstrap.js"],"sourcesContent":["import { Events } from 'nextbone'\r\nimport { defineAsyncMethods } from 'nextbone/service'\r\nimport { last, without } from 'underscore'\r\n\r\n/**\r\n * @class Modals\r\n */\r\nexport class Modals extends Events {\r\n  /**\r\n   * @constructs Modals\r\n   */\r\n  constructor (channelName) {\r\n    super(channelName)\r\n    this.views = []\r\n  }\r\n\r\n  createElement (type) {\r\n    return document.createElement(`nextbone-modal-${type}`)\r\n  }\r\n\r\n  /**\r\n   * @method open\r\n   * @param {HTMLElement} [view]\r\n   * @returns {Promise}\r\n   */\r\n  open (view, options) {\r\n    let previousView\r\n    view.options = options\r\n    return Promise.resolve().then(() => {\r\n      this.trigger('before:open', view, options)\r\n      this._isOpen = true\r\n\r\n      previousView = last(this.views)\r\n      this.views.push(view)\r\n\r\n      return this.render(view, options)\r\n    }).then(() => {\r\n      if (previousView) {\r\n        return this.animateSwap(previousView, view, options)\r\n      } else {\r\n        return this.animateIn(view, options)\r\n      }\r\n    }).then(() => {\r\n      this.trigger('open', view, options)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method close\r\n   * @param {HTMLElement} [view]\r\n   * @returns {Promise}\r\n   */\r\n  close (view, options) {\r\n    let previousView\r\n    let views\r\n\r\n    return Promise.resolve().then(() => {\r\n      if (view) {\r\n        this.trigger('before:close', view, options)\r\n      } else {\r\n        this.views.map(view => this.trigger('before:close', view, options))\r\n      }\r\n\r\n      this._isOpen = false\r\n\r\n      if (view) {\r\n        views = this.views = without(this.views, view)\r\n      } else {\r\n        views = this.views\r\n        this.views = []\r\n      }\r\n\r\n      previousView = last(views)\r\n\r\n      if (view && previousView) {\r\n        return this.animateSwap(view, previousView, options)\r\n      } else if (view) {\r\n        return this.animateOut(view, options)\r\n      } else if (previousView) {\r\n        return this.animateOut(previousView, options)\r\n      }\r\n    }).then(() => {\r\n      if (view) {\r\n        return this.remove(view, options)\r\n      } else {\r\n        return Promise.all(views.map(view => this.remove(view, options)))\r\n      }\r\n    }).then(() => {\r\n      if (view) {\r\n        this.trigger('close', view, options)\r\n      } else {\r\n        views.map(view => this.trigger('close', view, options))\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method alert\r\n   * @param {Object} [options]\r\n   * @returns {Promise}\r\n   */\r\n  alert (options = {}) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('alert')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:alert', view, options)\r\n\r\n      view.on('confirm cancel', () => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('alert', null, view, options))\r\n          .then(() => resolve(), reject)\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method confirm\r\n   * @param {Object} [options]\r\n   * @returns {Promise}\r\n   */\r\n  confirm (options = {}) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('confirm')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:confirm', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('confirm', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        confirm: () => close(true),\r\n        cancel: () => close(false)\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method prompt\r\n   * @returns {Promise}\r\n   */\r\n  prompt (options = {}) {\r\n    return new Promise((resolve, reject) => {\r\n      let view = this.createElement('prompt')\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:prompt', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('prompt', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        submit: text => close(text),\r\n        cancel: () => close()\r\n      })\r\n    })\r\n  }\r\n\r\n  dialog (view, options = {}) {\r\n    if (!view) {\r\n      throw new Error('ModalService: no view option passed to dialog')\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      let promise = this.open(view, options)\r\n\r\n      this.trigger('before:dialog', view, options)\r\n\r\n      let close = result => {\r\n        promise\r\n          .then(() => this.close(view, options))\r\n          .then(() => this.trigger('dialog', result, view, options))\r\n          .then(() => resolve(result), reject)\r\n      }\r\n\r\n      view.on({\r\n        submit: data => close(data),\r\n        cancel: () => close()\r\n      })\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @method isOpen\r\n   * @returns {Boolean}\r\n   */\r\n  isOpen () {\r\n    return !!this._isOpen\r\n  }\r\n\r\n  /**\r\n   * @abstract\r\n   * @method render\r\n   */\r\n  render () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method remove\r\n   */\r\n  remove () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateIn\r\n   */\r\n  animateIn () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateSwap\r\n   */\r\n  animateSwap () {}\r\n\r\n  /**\r\n   * @abstract\r\n   * @method animateOut\r\n   */\r\n  animateOut () {}\r\n}\r\n\r\n\r\ndefineAsyncMethods(Modals, ['open', 'close', 'confirm', 'prompt', 'dialog'])\r\n","import { Events } from 'nextbone'\r\n\r\nconst defaultCaptions = {\r\n  ok: 'OK',\r\n  cancel: 'Cancel',\r\n  yes: 'Yes',\r\n  no: 'No'\r\n}\r\n\r\nclass BaseModal extends HTMLElement {\r\n  confirmClick () {\r\n    this.trigger('confirm')\r\n  }\r\n\r\n  cancelClick (e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    this.trigger('cancel')\r\n  }\r\n\r\n  submit (e) {\r\n    e.preventDefault()\r\n    const val = this.querySelector('input').value\r\n    this.trigger('submit', val)\r\n  }\r\n\r\n  bindEvent (selector, event, listener) {\r\n    const el = this.querySelector(selector)\r\n    if (el) el.addEventListener(event, listener.bind(this))\r\n  }\r\n\r\n  connectedCallback () {\r\n    this.innerHTML = this.render(this.options)\r\n    this.bindEvent('.btn-primary', 'click', this.confirmClick)\r\n    this.bindEvent('.close', 'click', this.cancelClick)\r\n    this.bindEvent('.btn-secondary', 'click', this.cancelClick)\r\n    this.bindEvent('form', 'submit', this.submit)\r\n  }\r\n}\r\n\r\nEvents.extend(BaseModal.prototype)\r\n\r\nclass AlertView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <div class=\"modal-header\">\r\n      <h5 class=\"modal-title\">${data.title}</h5>\r\n      <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n    </div>\r\n\r\n    <div class=\"modal-body\">\r\n      <p>${data.text}</p>\r\n    </div>\r\n\r\n    <div class=\"modal-footer\">\r\n      <button type=\"button\" class=\"btn btn-primary\">${data.ok || defaultCaptions.ok}</button>\r\n    </div>\r\n    `\r\n  }\r\n}\r\n\r\nclass PromptView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <form>\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\">${data.title}</h5>\r\n        <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n      </div>\r\n\r\n      <div class=\"modal-body\">\r\n        <div class=\"form-group\">\r\n          <label for=\"modal__input--prompt\">${data.text}</label>\r\n          <input id=\"modal__input--prompt\" class=\"form-control\" type=\"text\" value=\"${data.value || ''}\">\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"modal-footer\">\r\n        <button type=\"button\" class=\"btn btn-secondary\">${data.cancel || defaultCaptions.cancel}</button>\r\n        <button type=\"submit\" class=\"btn btn-primary\">${data.ok || defaultCaptions.ok}</button>\r\n      </div>\r\n    </form>\r\n    `\r\n  }\r\n}\r\n\r\nclass ConfirmView extends BaseModal {\r\n  render (data) {\r\n    return `\r\n    <div class=\"modal-header\">\r\n      <h5 class=\"modal-title\">${data.title}</h5>\r\n      <button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>      \r\n    </div>\r\n    \r\n    <div class=\"modal-body\">\r\n      <p>${data.text}</p>\r\n    </div>\r\n    \r\n    <div class=\"modal-footer\">\r\n      <button type=\"button\" class=\"btn btn-secondary\">${data.no || defaultCaptions.no}</button>\r\n      <button type=\"button\" class=\"btn btn-primary\">${data.yes || defaultCaptions.yes}</button>\r\n    </div>      \r\n    `\r\n  }\r\n}\r\n\r\nexport { AlertView, ConfirmView, PromptView, defaultCaptions }\r\n","import $ from 'jquery'\r\nimport { Region } from 'nextbone/dom-utils'\r\nimport { Modals } from './service'\r\nimport { AlertView, PromptView, ConfirmView, defaultCaptions } from './bootstrap-views'\r\n\r\nconst layoutTemplate = `\r\n<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">\r\n  <div class=\"modal-dialog\">\r\n  </div>\r\n</div>\r\n`\r\n\r\nconst elementClasses = {\r\n  alert: AlertView,\r\n  prompt: PromptView,\r\n  confirm: ConfirmView\r\n}\r\n\r\nexport class BootstrapModals extends Modals {\r\n  static setCaptions (captions = {}) {\r\n    Object.assign(defaultCaptions, captions)\r\n  }\r\n\r\n  setup (options = {}) {\r\n    this.container = options.container\r\n  }\r\n\r\n  createElement (type) {\r\n    const name = `bootstrap-modal-${type}`\r\n    if (!customElements.get(name)) {\r\n      customElements.define(name, elementClasses[type])\r\n    }\r\n    return document.createElement(name)\r\n  }\r\n\r\n  start () {\r\n    if (!this.container) {\r\n      throw new Error('Bootstrap Modals: container option is not defined')\r\n    }\r\n\r\n    const $container = $(this.container)\r\n    if (!$container.length) {\r\n      throw new Error(`Bootstrap Modals: unable to find container element (${this.container})`)\r\n    }\r\n\r\n    $container.html(layoutTemplate)\r\n\r\n    const $layout = this.$layout = $container.children().eq(0)\r\n\r\n    $layout.modal({\r\n      show: false,\r\n      backdrop: 'static'\r\n    })\r\n\r\n    $layout.on({\r\n      'shown.bs.modal': (e) => this.trigger('modal:show', e),\r\n      'hidden.bs.modal': (e) => this.trigger('modal:hide', e)\r\n    })\r\n\r\n    const $dialog = $layout.find('.modal-dialog')\r\n\r\n    this.contentRegion = new Region($dialog[0])\r\n\r\n    this.on('before:open', (view, options) => {\r\n      const {size, scrollable, centered} = options\r\n      let dialogClasses = ''\r\n      if (size) {\r\n        dialogClasses += ` modal-${size}`\r\n      }\r\n      if (scrollable) {\r\n        dialogClasses += ` modal-dialog-scrollable`\r\n      }\r\n      if (centered) {\r\n        dialogClasses += ` modal-dialog-centered`\r\n      }\r\n\r\n      if (dialogClasses) {\r\n        $dialog.addClass(dialogClasses)\r\n      }\r\n      this.__dialogClasses = dialogClasses\r\n    })\r\n\r\n    this.on('close', () => {\r\n      $dialog.removeClass(this.__dialogClasses)\r\n    })\r\n  }\r\n\r\n  render (view) {\r\n    view.classList.add('modal-content')\r\n    this.contentRegion.show(view)\r\n  }\r\n\r\n  remove () {\r\n    this.contentRegion.empty()\r\n  }\r\n\r\n  animateIn () {\r\n    return new Promise(resolve => {\r\n      this.once('modal:show', resolve)\r\n      this.$layout.modal('show')\r\n    })\r\n  }\r\n\r\n  animateOut () {\r\n    return new Promise(resolve => {\r\n      this.once('modal:hide', resolve)\r\n      this.$layout.modal('hide')\r\n    })\r\n  }\r\n}\r\n"],"names":["Modals","Events","constructor","channelName","views","createElement","type","document","open","view","options","previousView","Promise","resolve","then","trigger","_isOpen","last","push","render","animateSwap","animateIn","close","map","without","animateOut","remove","all","alert","reject","promise","on","confirm","result","cancel","prompt","submit","text","dialog","Error","data","isOpen","defineAsyncMethods","defaultCaptions","ok","yes","no","BaseModal","HTMLElement","confirmClick","cancelClick","e","stopPropagation","preventDefault","val","querySelector","value","bindEvent","selector","event","listener","el","addEventListener","bind","connectedCallback","innerHTML","extend","prototype","AlertView","title","PromptView","ConfirmView","layoutTemplate","elementClasses","BootstrapModals","setCaptions","captions","Object","assign","setup","container","name","customElements","get","define","start","$container","$","length","html","$layout","children","eq","modal","show","backdrop","$dialog","find","contentRegion","Region","size","scrollable","centered","dialogClasses","addClass","__dialogClasses","removeClass","classList","add","empty","once"],"mappings":";;;;;;AAIA;;;;AAGA,AAAO,MAAMA,MAAN,SAAqBC,MAArB,CAA4B;;;;EAIjCC,WAAW,CAAEC,WAAF,EAAe;UAClBA,WAAN;SACKC,KAAL,GAAa,EAAb;;;EAGFC,aAAa,CAAEC,IAAF,EAAQ;WACZC,QAAQ,CAACF,aAAT,CAAwB,kBAAiBC,IAAK,EAA9C,CAAP;;;;;;;;;EAQFE,IAAI,CAAEC,IAAF,EAAQC,OAAR,EAAiB;QACfC,YAAJ;IACAF,IAAI,CAACC,OAAL,GAAeA,OAAf;WACOE,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,MAAM;WAC7BC,OAAL,CAAa,aAAb,EAA4BN,IAA5B,EAAkCC,OAAlC;WACKM,OAAL,GAAe,IAAf;MAEAL,YAAY,GAAGM,IAAI,CAAC,KAAKb,KAAN,CAAnB;WACKA,KAAL,CAAWc,IAAX,CAAgBT,IAAhB;aAEO,KAAKU,MAAL,CAAYV,IAAZ,EAAkBC,OAAlB,CAAP;KAPK,EAQJI,IARI,CAQC,MAAM;UACRH,YAAJ,EAAkB;eACT,KAAKS,WAAL,CAAiBT,YAAjB,EAA+BF,IAA/B,EAAqCC,OAArC,CAAP;OADF,MAEO;eACE,KAAKW,SAAL,CAAeZ,IAAf,EAAqBC,OAArB,CAAP;;KAZG,EAcJI,IAdI,CAcC,MAAM;WACPC,OAAL,CAAa,MAAb,EAAqBN,IAArB,EAA2BC,OAA3B;KAfK,CAAP;;;;;;;;;EAwBFY,KAAK,CAAEb,IAAF,EAAQC,OAAR,EAAiB;QAChBC,YAAJ;QACIP,KAAJ;WAEOQ,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,MAAM;UAC9BL,IAAJ,EAAU;aACHM,OAAL,CAAa,cAAb,EAA6BN,IAA7B,EAAmCC,OAAnC;OADF,MAEO;aACAN,KAAL,CAAWmB,GAAX,CAAed,IAAI,IAAI,KAAKM,OAAL,CAAa,cAAb,EAA6BN,IAA7B,EAAmCC,OAAnC,CAAvB;;;WAGGM,OAAL,GAAe,KAAf;;UAEIP,IAAJ,EAAU;QACRL,KAAK,GAAG,KAAKA,KAAL,GAAaoB,OAAO,CAAC,KAAKpB,KAAN,EAAaK,IAAb,CAA5B;OADF,MAEO;QACLL,KAAK,GAAG,KAAKA,KAAb;aACKA,KAAL,GAAa,EAAb;;;MAGFO,YAAY,GAAGM,IAAI,CAACb,KAAD,CAAnB;;UAEIK,IAAI,IAAIE,YAAZ,EAA0B;eACjB,KAAKS,WAAL,CAAiBX,IAAjB,EAAuBE,YAAvB,EAAqCD,OAArC,CAAP;OADF,MAEO,IAAID,IAAJ,EAAU;eACR,KAAKgB,UAAL,CAAgBhB,IAAhB,EAAsBC,OAAtB,CAAP;OADK,MAEA,IAAIC,YAAJ,EAAkB;eAChB,KAAKc,UAAL,CAAgBd,YAAhB,EAA8BD,OAA9B,CAAP;;KAvBG,EAyBJI,IAzBI,CAyBC,MAAM;UACRL,IAAJ,EAAU;eACD,KAAKiB,MAAL,CAAYjB,IAAZ,EAAkBC,OAAlB,CAAP;OADF,MAEO;eACEE,OAAO,CAACe,GAAR,CAAYvB,KAAK,CAACmB,GAAN,CAAUd,IAAI,IAAI,KAAKiB,MAAL,CAAYjB,IAAZ,EAAkBC,OAAlB,CAAlB,CAAZ,CAAP;;KA7BG,EA+BJI,IA/BI,CA+BC,MAAM;UACRL,IAAJ,EAAU;aACHM,OAAL,CAAa,OAAb,EAAsBN,IAAtB,EAA4BC,OAA5B;OADF,MAEO;QACLN,KAAK,CAACmB,GAAN,CAAUd,IAAI,IAAI,KAAKM,OAAL,CAAa,OAAb,EAAsBN,IAAtB,EAA4BC,OAA5B,CAAlB;;KAnCG,CAAP;;;;;;;;;EA6CFkB,KAAK,CAAElB,OAAO,GAAG,EAAZ,EAAgB;WACZ,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUgB,MAAV,KAAqB;UAClCpB,IAAI,GAAG,KAAKJ,aAAL,CAAmB,OAAnB,CAAX;UACIyB,OAAO,GAAG,KAAKtB,IAAL,CAAUC,IAAV,EAAgBC,OAAhB,CAAd;WAEKK,OAAL,CAAa,cAAb,EAA6BN,IAA7B,EAAmCC,OAAnC;MAEAD,IAAI,CAACsB,EAAL,CAAQ,gBAAR,EAA0B,MAAM;QAC9BD,OAAO,CACJhB,IADH,CACQ,MAAM,KAAKQ,KAAL,CAAWb,IAAX,EAAiBC,OAAjB,CADd,EAEGI,IAFH,CAEQ,MAAM,KAAKC,OAAL,CAAa,OAAb,EAAsB,IAAtB,EAA4BN,IAA5B,EAAkCC,OAAlC,CAFd,EAGGI,IAHH,CAGQ,MAAMD,OAAO,EAHrB,EAGyBgB,MAHzB;OADF;KANK,CAAP;;;;;;;;;EAoBFG,OAAO,CAAEtB,OAAO,GAAG,EAAZ,EAAgB;WACd,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUgB,MAAV,KAAqB;UAClCpB,IAAI,GAAG,KAAKJ,aAAL,CAAmB,SAAnB,CAAX;UACIyB,OAAO,GAAG,KAAKtB,IAAL,CAAUC,IAAV,EAAgBC,OAAhB,CAAd;WAEKK,OAAL,CAAa,gBAAb,EAA+BN,IAA/B,EAAqCC,OAArC;;UAEIY,KAAK,GAAGW,MAAM,IAAI;QACpBH,OAAO,CACJhB,IADH,CACQ,MAAM,KAAKQ,KAAL,CAAWb,IAAX,EAAiBC,OAAjB,CADd,EAEGI,IAFH,CAEQ,MAAM,KAAKC,OAAL,CAAa,SAAb,EAAwBkB,MAAxB,EAAgCxB,IAAhC,EAAsCC,OAAtC,CAFd,EAGGI,IAHH,CAGQ,MAAMD,OAAO,CAACoB,MAAD,CAHrB,EAG+BJ,MAH/B;OADF;;MAOApB,IAAI,CAACsB,EAAL,CAAQ;QACNC,OAAO,EAAE,MAAMV,KAAK,CAAC,IAAD,CADd;QAENY,MAAM,EAAE,MAAMZ,KAAK,CAAC,KAAD;OAFrB;KAbK,CAAP;;;;;;;;EAwBFa,MAAM,CAAEzB,OAAO,GAAG,EAAZ,EAAgB;WACb,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUgB,MAAV,KAAqB;UAClCpB,IAAI,GAAG,KAAKJ,aAAL,CAAmB,QAAnB,CAAX;UACIyB,OAAO,GAAG,KAAKtB,IAAL,CAAUC,IAAV,EAAgBC,OAAhB,CAAd;WAEKK,OAAL,CAAa,eAAb,EAA8BN,IAA9B,EAAoCC,OAApC;;UAEIY,KAAK,GAAGW,MAAM,IAAI;QACpBH,OAAO,CACJhB,IADH,CACQ,MAAM,KAAKQ,KAAL,CAAWb,IAAX,EAAiBC,OAAjB,CADd,EAEGI,IAFH,CAEQ,MAAM,KAAKC,OAAL,CAAa,QAAb,EAAuBkB,MAAvB,EAA+BxB,IAA/B,EAAqCC,OAArC,CAFd,EAGGI,IAHH,CAGQ,MAAMD,OAAO,CAACoB,MAAD,CAHrB,EAG+BJ,MAH/B;OADF;;MAOApB,IAAI,CAACsB,EAAL,CAAQ;QACNK,MAAM,EAAEC,IAAI,IAAIf,KAAK,CAACe,IAAD,CADf;QAENH,MAAM,EAAE,MAAMZ,KAAK;OAFrB;KAbK,CAAP;;;EAoBFgB,MAAM,CAAE7B,IAAF,EAAQC,OAAO,GAAG,EAAlB,EAAsB;QACtB,CAACD,IAAL,EAAW;YACH,IAAI8B,KAAJ,CAAU,+CAAV,CAAN;;;WAEK,IAAI3B,OAAJ,CAAY,CAACC,OAAD,EAAUgB,MAAV,KAAqB;UAClCC,OAAO,GAAG,KAAKtB,IAAL,CAAUC,IAAV,EAAgBC,OAAhB,CAAd;WAEKK,OAAL,CAAa,eAAb,EAA8BN,IAA9B,EAAoCC,OAApC;;UAEIY,KAAK,GAAGW,MAAM,IAAI;QACpBH,OAAO,CACJhB,IADH,CACQ,MAAM,KAAKQ,KAAL,CAAWb,IAAX,EAAiBC,OAAjB,CADd,EAEGI,IAFH,CAEQ,MAAM,KAAKC,OAAL,CAAa,QAAb,EAAuBkB,MAAvB,EAA+BxB,IAA/B,EAAqCC,OAArC,CAFd,EAGGI,IAHH,CAGQ,MAAMD,OAAO,CAACoB,MAAD,CAHrB,EAG+BJ,MAH/B;OADF;;MAOApB,IAAI,CAACsB,EAAL,CAAQ;QACNK,MAAM,EAAEI,IAAI,IAAIlB,KAAK,CAACkB,IAAD,CADf;QAENN,MAAM,EAAE,MAAMZ,KAAK;OAFrB;KAZK,CAAP;;;;;;;;EAuBFmB,MAAM,GAAI;WACD,CAAC,CAAC,KAAKzB,OAAd;;;;;;;;EAOFG,MAAM,GAAI;;;;;;;EAMVO,MAAM,GAAI;;;;;;;EAMVL,SAAS,GAAI;;;;;;;EAMbD,WAAW,GAAI;;;;;;;EAMfK,UAAU,GAAI;;;AAIhBiB,kBAAkB,CAAC1C,MAAD,EAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,SAAlB,EAA6B,QAA7B,EAAuC,QAAvC,CAAT,CAAlB;;ACrOA,MAAM2C,eAAe,GAAG;EACtBC,EAAE,EAAE,IADkB;EAEtBV,MAAM,EAAE,QAFc;EAGtBW,GAAG,EAAE,KAHiB;EAItBC,EAAE,EAAE;CAJN;;AAOA,MAAMC,SAAN,SAAwBC,WAAxB,CAAoC;EAClCC,YAAY,GAAI;SACTlC,OAAL,CAAa,SAAb;;;EAGFmC,WAAW,CAAEC,CAAF,EAAK;IACdA,CAAC,CAACC,eAAF;IACAD,CAAC,CAACE,cAAF;SACKtC,OAAL,CAAa,QAAb;;;EAGFqB,MAAM,CAAEe,CAAF,EAAK;IACTA,CAAC,CAACE,cAAF;UACMC,GAAG,GAAG,KAAKC,aAAL,CAAmB,OAAnB,EAA4BC,KAAxC;SACKzC,OAAL,CAAa,QAAb,EAAuBuC,GAAvB;;;EAGFG,SAAS,CAAEC,QAAF,EAAYC,KAAZ,EAAmBC,QAAnB,EAA6B;UAC9BC,EAAE,GAAG,KAAKN,aAAL,CAAmBG,QAAnB,CAAX;QACIG,EAAJ,EAAQA,EAAE,CAACC,gBAAH,CAAoBH,KAApB,EAA2BC,QAAQ,CAACG,IAAT,CAAc,IAAd,CAA3B;;;EAGVC,iBAAiB,GAAI;SACdC,SAAL,GAAiB,KAAK9C,MAAL,CAAY,KAAKT,OAAjB,CAAjB;SACK+C,SAAL,CAAe,cAAf,EAA+B,OAA/B,EAAwC,KAAKR,YAA7C;SACKQ,SAAL,CAAe,QAAf,EAAyB,OAAzB,EAAkC,KAAKP,WAAvC;SACKO,SAAL,CAAe,gBAAf,EAAiC,OAAjC,EAA0C,KAAKP,WAA/C;SACKO,SAAL,CAAe,MAAf,EAAuB,QAAvB,EAAiC,KAAKrB,MAAtC;;;;;AAIJnC,MAAM,CAACiE,MAAP,CAAcnB,SAAS,CAACoB,SAAxB;;AAEA,MAAMC,SAAN,SAAwBrB,SAAxB,CAAkC;EAChC5B,MAAM,CAAEqB,IAAF,EAAQ;WACJ;;gCAEoBA,IAAI,CAAC6B,KAAM;;;;;WAKhC7B,IAAI,CAACH,IAAK;;;;sDAIiCG,IAAI,CAACI,EAAL,IAAWD,eAAe,CAACC,EAAG;;KAXhF;;;;;AAiBJ,MAAM0B,UAAN,SAAyBvB,SAAzB,CAAmC;EACjC5B,MAAM,CAAEqB,IAAF,EAAQ;WACJ;;;kCAGsBA,IAAI,CAAC6B,KAAM;;;;;;8CAMC7B,IAAI,CAACH,IAAK;qFAC6BG,IAAI,CAACgB,KAAL,IAAc,EAAG;;;;;0DAK5ChB,IAAI,CAACN,MAAL,IAAeS,eAAe,CAACT,MAAO;wDACxCM,IAAI,CAACI,EAAL,IAAWD,eAAe,CAACC,EAAG;;;KAhBlF;;;;;AAuBJ,MAAM2B,WAAN,SAA0BxB,SAA1B,CAAoC;EAClC5B,MAAM,CAAEqB,IAAF,EAAQ;WACJ;;gCAEoBA,IAAI,CAAC6B,KAAM;;;;;WAKhC7B,IAAI,CAACH,IAAK;;;;wDAImCG,IAAI,CAACM,EAAL,IAAWH,eAAe,CAACG,EAAG;sDAChCN,IAAI,CAACK,GAAL,IAAYF,eAAe,CAACE,GAAI;;KAZlF;;;;;ACnFJ,MAAM2B,cAAc,GAAI;;;;;CAAxB;AAOA,MAAMC,cAAc,GAAG;EACrB7C,KAAK,EAAEwC,SADc;EAErBjC,MAAM,EAAEmC,UAFa;EAGrBtC,OAAO,EAAEuC;CAHX;AAMA,AAAO,MAAMG,eAAN,SAA8B1E,MAA9B,CAAqC;SACnC2E,WAAP,CAAoBC,QAAQ,GAAG,EAA/B,EAAmC;IACjCC,MAAM,CAACC,MAAP,CAAcnC,eAAd,EAA+BiC,QAA/B;;;EAGFG,KAAK,CAAErE,OAAO,GAAG,EAAZ,EAAgB;SACdsE,SAAL,GAAiBtE,OAAO,CAACsE,SAAzB;;;EAGF3E,aAAa,CAAEC,IAAF,EAAQ;UACb2E,IAAI,GAAI,mBAAkB3E,IAAK,EAArC;;QACI,CAAC4E,cAAc,CAACC,GAAf,CAAmBF,IAAnB,CAAL,EAA+B;MAC7BC,cAAc,CAACE,MAAf,CAAsBH,IAAtB,EAA4BR,cAAc,CAACnE,IAAD,CAA1C;;;WAEKC,QAAQ,CAACF,aAAT,CAAuB4E,IAAvB,CAAP;;;EAGFI,KAAK,GAAI;QACH,CAAC,KAAKL,SAAV,EAAqB;YACb,IAAIzC,KAAJ,CAAU,mDAAV,CAAN;;;UAGI+C,UAAU,GAAGC,CAAC,CAAC,KAAKP,SAAN,CAApB;;QACI,CAACM,UAAU,CAACE,MAAhB,EAAwB;YAChB,IAAIjD,KAAJ,CAAW,uDAAsD,KAAKyC,SAAU,GAAhF,CAAN;;;IAGFM,UAAU,CAACG,IAAX,CAAgBjB,cAAhB;UAEMkB,OAAO,GAAG,KAAKA,OAAL,GAAeJ,UAAU,CAACK,QAAX,GAAsBC,EAAtB,CAAyB,CAAzB,CAA/B;IAEAF,OAAO,CAACG,KAAR,CAAc;MACZC,IAAI,EAAE,KADM;MAEZC,QAAQ,EAAE;KAFZ;IAKAL,OAAO,CAAC3D,EAAR,CAAW;wBACUoB,CAAD,IAAO,KAAKpC,OAAL,CAAa,YAAb,EAA2BoC,CAA3B,CADhB;yBAEWA,CAAD,IAAO,KAAKpC,OAAL,CAAa,YAAb,EAA2BoC,CAA3B;KAF5B;UAKM6C,OAAO,GAAGN,OAAO,CAACO,IAAR,CAAa,eAAb,CAAhB;SAEKC,aAAL,GAAqB,IAAIC,MAAJ,CAAWH,OAAO,CAAC,CAAD,CAAlB,CAArB;SAEKjE,EAAL,CAAQ,aAAR,EAAuB,CAACtB,IAAD,EAAOC,OAAP,KAAmB;YAClC;QAAC0F,IAAD;QAAOC,UAAP;QAAmBC;UAAY5F,OAArC;UACI6F,aAAa,GAAG,EAApB;;UACIH,IAAJ,EAAU;QACRG,aAAa,IAAK,UAASH,IAAK,EAAhC;;;UAEEC,UAAJ,EAAgB;QACdE,aAAa,IAAK,0BAAlB;;;UAEED,QAAJ,EAAc;QACZC,aAAa,IAAK,wBAAlB;;;UAGEA,aAAJ,EAAmB;QACjBP,OAAO,CAACQ,QAAR,CAAiBD,aAAjB;;;WAEGE,eAAL,GAAuBF,aAAvB;KAhBF;SAmBKxE,EAAL,CAAQ,OAAR,EAAiB,MAAM;MACrBiE,OAAO,CAACU,WAAR,CAAoB,KAAKD,eAAzB;KADF;;;EAKFtF,MAAM,CAAEV,IAAF,EAAQ;IACZA,IAAI,CAACkG,SAAL,CAAeC,GAAf,CAAmB,eAAnB;SACKV,aAAL,CAAmBJ,IAAnB,CAAwBrF,IAAxB;;;EAGFiB,MAAM,GAAI;SACHwE,aAAL,CAAmBW,KAAnB;;;EAGFxF,SAAS,GAAI;WACJ,IAAIT,OAAJ,CAAYC,OAAO,IAAI;WACvBiG,IAAL,CAAU,YAAV,EAAwBjG,OAAxB;WACK6E,OAAL,CAAaG,KAAb,CAAmB,MAAnB;KAFK,CAAP;;;EAMFpE,UAAU,GAAI;WACL,IAAIb,OAAJ,CAAYC,OAAO,IAAI;WACvBiG,IAAL,CAAU,YAAV,EAAwBjG,OAAxB;WACK6E,OAAL,CAAaG,KAAb,CAAmB,MAAnB;KAFK,CAAP;;;;;;;"}